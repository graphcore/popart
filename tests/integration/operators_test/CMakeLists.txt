# Copyright (c) 2021 Graphcore Ltd. All rights reserved.
add_popart_py_unit_test(abs_sign_test)
add_popart_py_unit_test(asinh_test)
add_popart_py_unit_test(atan2_test)
add_popart_py_unit_test(atanh_test)
add_popart_py_unit_test(auto_pad_test PROPERTIES DISABLED TRUE) # TODO Disabled, see comment in file.
add_popart_py_unit_test(batchnorm_test)
add_popart_py_unit_test(batchnorm_pytorch_fp16_test VARIANTS Hw)
add_popart_py_unit_test(binaryop_error_test)
add_popart_py_unit_test(boolean_test)
add_popart_py_unit_test(bucketize_test)
add_popart_py_unit_test(call_test)
add_popart_py_unit_test(call_test_ipu_model VARIANTS IpuModel2)
add_popart_py_unit_test(cast_test_py VARIANTS Hw) # Run on Hw, because float16 is not accurately modelled on IpuModel.
add_popart_py_unit_test(clip_test)
add_popart_py_unit_test(constexpr_2d_transpose)
add_popart_py_unit_test(constexpr_add)
add_popart_py_unit_test(constexpr_gather)
add_popart_py_unit_test(constexpr_gemm_decomposition)
add_popart_py_unit_test(constexpr_slice)
add_popart_py_unit_test(constexpr_unsqueeze)
add_popart_py_unit_test(copy_var_update_test)
add_popart_py_unit_test(ctc_beam_search_decoder VARIANTS IpuModel2)
add_popart_py_unit_test(cumsum_test)
add_popart_py_unit_test(depthtospace_test)
add_popart_py_unit_test(detach_test)
add_popart_py_unit_test(dropout_test VARIANTS Hw)
add_popart_py_unit_test(dynamicslice_test)
add_popart_py_unit_test(dynamicupdate_test)
add_popart_py_unit_test(dynamicadd_test)
add_popart_py_unit_test(dynamiczero_test)
add_popart_py_unit_test(dynamicslice_large_test VARIANTS Hw)
add_popart_py_unit_test(elu_test)
add_popart_py_unit_test(erf_test)
add_popart_py_unit_test(exp_test)
add_popart_py_unit_test(expm1_test)
add_popart_py_unit_test(expand_test)
add_popart_py_unit_test(flatten_test)
add_popart_py_unit_test(gather_big_test)
add_popart_py_unit_test(gather_bigger_test)
add_popart_py_unit_test(gather_test)
add_popart_py_unit_test(gelu_test)
add_popart_py_unit_test(gemm_test)
add_popart_py_unit_test(groupnorm_test)
add_popart_py_unit_test(gru_test)
add_popart_py_unit_test(gt_lt_test)
add_popart_py_unit_test(hardsigmoid_test)
add_popart_py_unit_test(incrementmod_test)
add_popart_py_unit_test(isnotfinite_test)
add_popart_py_unit_test(l1_test)
add_popart_py_unit_test(leakyrelu_test)
add_popart_py_unit_test(log1p_test)
add_popart_py_unit_test(logsoftmax_test)
add_popart_py_unit_test(if_test)
add_popart_py_unit_test(loop_test)
add_popart_py_unit_test(loss_test VARIANTS IpuModel2)
add_popart_py_unit_test(identity_loss_test)
add_popart_py_unit_test(lrn_test)
add_popart_py_unit_test(lstm_test VARIANTS IpuModel2)
add_popart_py_unit_test(lstm_test_2 VARIANTS IpuModel2)
add_popart_py_unit_test(keras_lstm_tests VARIANTS IpuModel2)
add_popart_py_unit_test(matmul_test_basic)
add_popart_py_unit_test(matmul_test_mismatched_inputs)
add_popart_py_unit_test(matmul_test_scalar_input)
add_popart_py_unit_test(matmul_test_grouped)
add_popart_py_unit_test(matmul_test_broadcasting_0)
add_popart_py_unit_test(matmul_test_broadcasting_1)
add_popart_py_unit_test(matmul_test_broadcasting_2)
add_popart_py_unit_test(matmul_test_broadcasting_3)
add_popart_py_unit_test(matmul_test_broadcasting_4)
add_popart_py_unit_test(matmul_test_broadcasting_5)
add_popart_py_unit_test(matmul_test_broadcasting_6)
add_popart_py_unit_test(min_max_test)
add_popart_py_unit_test(mul_test)
add_popart_py_unit_test(multiconv_test)
add_popart_py_unit_test(onehot_test)
add_popart_py_unit_test(operators_test)
add_popart_py_unit_test(operators_test_2)
add_popart_py_unit_test(pattern_op_removal_test)
add_popart_py_unit_test(pooling_test)
add_popart_py_unit_test(pow_test)
add_popart_py_unit_test(randomnormal_test VARIANTS Hw)
add_popart_py_unit_test(randomnormallike_test VARIANTS Hw)
add_popart_py_unit_test(randomuniform_test VARIANTS Hw)
add_popart_py_unit_test(randomuniformlike_test VARIANTS Hw)
add_popart_py_unit_test(reducel1_test)
add_popart_py_unit_test(reducel2_test)
add_popart_py_unit_test(reducelogsum_test)
add_popart_py_unit_test(reducelogsumexp_test)
add_popart_py_unit_test(reducemax_test)
add_popart_py_unit_test(reducemean_test)
add_popart_py_unit_test(reducemedian_test)
add_popart_py_unit_test(reducemin_test)
add_popart_py_unit_test(reduceprod_test)
add_popart_py_unit_test(reducesum_test)
add_popart_py_unit_test(reducesumsquare_test)
add_popart_py_unit_test(reduce_invalid_axes_test)
add_popart_py_unit_test(reshape_test)
add_popart_py_unit_test(rnn_test VARIANTS IpuModel2)
add_popart_py_unit_test(scan_test)
add_popart_py_unit_test(scaledadd_test)
add_popart_py_unit_test(scatter_test)
add_popart_py_unit_test(scatterreduce_test_0 VARIANTS IpuModel2)
add_popart_py_unit_test(scatterreduce_test_1 VARIANTS IpuModel2)
add_popart_py_unit_test(scatterreduce_bcast_test_0 VARIANTS IpuModel2)
add_popart_py_unit_test(scatterreduce_bcast_test_1 VARIANTS IpuModel2)
add_popart_py_unit_test(scatterreduce_bcast_disabled_test VARIANTS IpuModel2)
add_popart_py_unit_test(selu_test)
add_popart_py_unit_test(sequenceslice_test)
add_popart_py_unit_test(shapeddropout_test VARIANTS Hw)
add_popart_py_unit_test(shrink_test)
add_popart_py_unit_test(slice_test)
add_popart_py_unit_test(softmax_test)
add_popart_py_unit_test(softplus_test)
add_popart_py_unit_test(softsign_test)
add_popart_py_unit_test(split_test)
add_popart_py_unit_test(squeeze_test)
add_popart_py_unit_test(sub_test)
add_popart_py_unit_test(subgraph_op_test)
add_popart_py_unit_test(subsample_test)
add_popart_py_unit_test(sum_mean_test)
add_popart_py_unit_test(swish_test)
add_popart_py_unit_test(tensorremap_test VARIANTS IpuModel2)
add_popart_py_unit_test(thresholdedrelu_test)
add_popart_py_unit_test(tile_test)
add_popart_py_unit_test(topk_test)
add_popart_py_unit_test(trig_test)
add_popart_py_unit_test(unsqueeze_test)
add_popart_py_unit_test(resize_test_0)
add_popart_py_unit_test(resize_test_1)
add_popart_py_unit_test(prelu_test)
add_popart_py_unit_test(upsample_test)
add_popart_py_unit_test(packed_data_test)
add_popart_py_unit_test(packed_data_test_ipu_model VARIANTS IpuModel2)
add_popart_py_unit_test(roialign_test VARIANTS IpuModel2)

add_unit_test(cast_test cast_test.cpp)
add_unit_test(histogram_test histogram_test.cpp)
add_unit_test(loop_alias_test loop_alias_test.cpp)
add_unit_test(lossscaleupdate_test loss_scale_update_test.cpp)
add_unit_test(hostop_test hostop_test.cpp VARIANTS "Hw")
